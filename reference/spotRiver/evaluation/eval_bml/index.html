
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="spotPython for River - Online machine learning in Python">
      
      
      
        <link rel="canonical" href="https://github.com/sequential-parameter-optimization/spotRiver/reference/spotRiver/evaluation/eval_bml/">
      
      
        <link rel="prev" href="../../drift/drift_generator/">
      
      
        <link rel="next" href="../eval_nowcast/">
      
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>eval_bml - spotRiver</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spotRiver.evaluation.eval_bml" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="spotRiver" class="md-header__button md-logo" aria-label="spotRiver" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotRiver
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              eval_bml
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sequential-parameter-optimization/spotRiver" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../data/" class="md-tabs__link">
          
  
    
  
  Code Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-tabs__link">
        
  
    
  
  Documentation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../download/" class="md-tabs__link">
        
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../examples/" class="md-tabs__link">
        
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="spotRiver" class="md-nav__button md-logo" aria-label="spotRiver" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    spotRiver
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sequential-parameter-optimization/spotRiver" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    spotRiver
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            spotRiver
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    drift
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            drift
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../drift/drift_generator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    drift_generator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    evaluation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    eval_bml
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    eval_bml
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor" class="md-nav__link">
    <span class="md-ellipsis">
      ResourceMonitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResourceMonitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor.result" class="md-nav__link">
    <span class="md-ellipsis">
      result
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_horizon" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml_horizon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_landmark" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml_landmark
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_window" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon" class="md-nav__link">
    <span class="md-ellipsis">
      eval_oml_horizon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.gen_sliding_window" class="md-nav__link">
    <span class="md-ellipsis">
      gen_sliding_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      plot_bml_oml_horizon_metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions" class="md-nav__link">
    <span class="md-ellipsis">
      plot_bml_oml_horizon_predictions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eval_nowcast/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eval_nowcast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eval_oml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eval_oml
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    fun
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            fun
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hyperriver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperriver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hyperriver_old/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hyperriver_old
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_5" >
        
          
          <label class="md-nav__link" for="__nav_2_1_5" id="__nav_2_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    plot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            plot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stats
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_6" >
        
          
          <label class="md-nav__link" for="__nav_2_1_6" id="__nav_2_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    preprocess
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            preprocess
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocess/impute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    impute
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_7" >
        
          
          <label class="md-nav__link" for="__nav_2_1_7" id="__nav_2_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    tuner
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            tuner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tuner/run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_8" >
        
          
          <label class="md-nav__link" for="__nav_2_1_8" id="__nav_2_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_8">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/data_conversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_conversion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    features
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hyperparameter-tuning-cookbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor" class="md-nav__link">
    <span class="md-ellipsis">
      ResourceMonitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResourceMonitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor.result" class="md-nav__link">
    <span class="md-ellipsis">
      result
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_horizon" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml_horizon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_landmark" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml_landmark
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_window" class="md-nav__link">
    <span class="md-ellipsis">
      eval_bml_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon" class="md-nav__link">
    <span class="md-ellipsis">
      eval_oml_horizon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.gen_sliding_window" class="md-nav__link">
    <span class="md-ellipsis">
      gen_sliding_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      plot_bml_oml_horizon_metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions" class="md-nav__link">
    <span class="md-ellipsis">
      plot_bml_oml_horizon_predictions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>eval_bml</h1>

<div class="doc doc-object doc-module">



<a id="spotRiver.evaluation.eval_bml"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="spotRiver.evaluation.eval_bml.ResourceMonitor" class="doc doc-heading">
          <code>ResourceMonitor</code>


<a href="#spotRiver.evaluation.eval_bml.ResourceMonitor" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A context manager for monitoring resource usage.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A description of the resource usage. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="spotRiver.evaluation.eval_bml.ResourceMonitorError">ResourceMonitorError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the resource monitor is already tracing memory usage.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="spotRiver.evaluation.eval_bml.ResourceMonitor" href="#spotRiver.evaluation.eval_bml.ResourceMonitor">ResourceMonitor</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A ResourceMonitor object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotRiver.evaluation.eval_bml</span> <span class="kn">import</span> <span class="n">ResourceMonitor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ResourceMonitor</span><span class="p">()</span> <span class="k">as</span> <span class="n">rm</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">rm</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
<span class="go">Resource usage:</span>
<span class="go">    Time [s]: 1.000000001</span>
<span class="go">    Memory [b]: 0.0</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ResourceMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A context manager for monitoring resource usage.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str, optional): A description of the resource usage. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        (ResourceMonitorError): If the resource monitor is already tracing memory usage.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (ResourceMonitor): A ResourceMonitor object.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import time</span>
<span class="sd">        &gt;&gt;&gt; from spotRiver.evaluation.eval_bml import ResourceMonitor</span>
<span class="sd">        &gt;&gt;&gt; with ResourceMonitor() as rm:</span>
<span class="sd">        ...     time.sleep(1)</span>
<span class="sd">        ...     print(rm.result())</span>
<span class="sd">        Resource usage:</span>
<span class="sd">            Time [s]: 1.000000001</span>
<span class="sd">            Memory [b]: 0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_memory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_memory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tracemalloc</span><span class="o">.</span><span class="n">is_tracing</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ResourceMonitorError</span><span class="p">(</span><span class="s2">&quot;Already tracing memory usage!&quot;</span><span class="p">)</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">reset_peak</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e9</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">peak</span> <span class="o">=</span> <span class="n">tracemalloc</span><span class="o">.</span><span class="n">get_traced_memory</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">peak</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a ResourceUsage object with the results of the resource monitor.</span>

<span class="sd">        Raises:</span>
<span class="sd">            (ResourceMonitorError): If the resource monitor has not been used yet.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (ResourceUsage): A ResourceUsage object.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; import time</span>
<span class="sd">            &gt;&gt;&gt; from spotRiver.evaluation.eval_bml import ResourceMonitor</span>
<span class="sd">            &gt;&gt;&gt; with ResourceMonitor() as rm:</span>
<span class="sd">            ...     time.sleep(1)</span>
<span class="sd">            ...     print(rm.result())</span>
<span class="sd">            Resource usage:</span>
<span class="sd">                Time [s]: 1.000000001</span>
<span class="sd">                Memory [b]: 0.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResourceMonitorError</span><span class="p">(</span><span class="s2">&quot;No resources monitored yet.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ResourceUsage</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="spotRiver.evaluation.eval_bml.ResourceMonitor.result" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">result</span><span class="p">()</span></code>

<a href="#spotRiver.evaluation.eval_bml.ResourceMonitor.result" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns a ResourceUsage object with the results of the resource monitor.</p>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="spotRiver.evaluation.eval_bml.ResourceMonitorError">ResourceMonitorError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the resource monitor has not been used yet.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="spotRiver.evaluation.eval_bml.ResourceUsage">ResourceUsage</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A ResourceUsage object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotRiver.evaluation.eval_bml</span> <span class="kn">import</span> <span class="n">ResourceMonitor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ResourceMonitor</span><span class="p">()</span> <span class="k">as</span> <span class="n">rm</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">rm</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
<span class="go">Resource usage:</span>
<span class="go">    Time [s]: 1.000000001</span>
<span class="go">    Memory [b]: 0.0</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a ResourceUsage object with the results of the resource monitor.</span>

<span class="sd">    Raises:</span>
<span class="sd">        (ResourceMonitorError): If the resource monitor has not been used yet.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (ResourceUsage): A ResourceUsage object.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import time</span>
<span class="sd">        &gt;&gt;&gt; from spotRiver.evaluation.eval_bml import ResourceMonitor</span>
<span class="sd">        &gt;&gt;&gt; with ResourceMonitor() as rm:</span>
<span class="sd">        ...     time.sleep(1)</span>
<span class="sd">        ...     print(rm.result())</span>
<span class="sd">        Resource usage:</span>
<span class="sd">            Time [s]: 1.000000001</span>
<span class="sd">            Memory [b]: 0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ResourceMonitorError</span><span class="p">(</span><span class="s2">&quot;No resources monitored yet.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ResourceUsage</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.eval_bml_horizon" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eval_bml_horizon</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.eval_bml_horizon" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate a machine learning model on a rolling horizon basis.
This function evaluates a machine learning model on a rolling horizon basis.
The model is trained on the training data and then evaluated on the test data
using a given evaluation metric. The evaluation results are returned as a tuple
of two data frames. The first one contains evaluation metrics for each window.
The second one contains the true and predicted values for each observation in the test set.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The model to be evaluated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>train</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The training data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>test</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The testing data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column containing the target variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of steps ahead to forecast.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_remainder</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include the remainder of the test dataframe if its length
is not divisible by the horizon. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An evaluation metric object that has an <code>evaluate</code> method.
This metric will be used to evaluate the model&rsquo;s performance on the test dataset.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of two data frames.</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first one contains evaluation metrics for each window.</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The second one contains the true and predicted values for each observation in the test set.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span> <span class="o">=</span> <span class="n">eval_bml_horizon</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df_eval</span><span class="p">)</span>
<span class="go">      Metric  Memory (MB)  CompTime (s)</span>
<span class="go">0  0.000000          0.0           0.0</span>
<span class="go">1  0.000000          0.0           0.0</span>
<span class="go">...        ...          ...           ...</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_bml_horizon</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate a machine learning model on a rolling horizon basis.</span>
<span class="sd">    This function evaluates a machine learning model on a rolling horizon basis.</span>
<span class="sd">    The model is trained on the training data and then evaluated on the test data</span>
<span class="sd">    using a given evaluation metric. The evaluation results are returned as a tuple</span>
<span class="sd">    of two data frames. The first one contains evaluation metrics for each window.</span>
<span class="sd">    The second one contains the true and predicted values for each observation in the test set.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (object): The model to be evaluated.</span>
<span class="sd">        train (pd.DataFrame): The training data set.</span>
<span class="sd">        test (pd.DataFrame): The testing data set.</span>
<span class="sd">        target_column (str): The name of the column containing the target variable.</span>
<span class="sd">        horizon (int, optional): The number of steps ahead to forecast.</span>
<span class="sd">        include_remainder (bool):</span>
<span class="sd">            Whether to include the remainder of the test dataframe if its length</span>
<span class="sd">            is not divisible by the horizon. Defaults to True.</span>
<span class="sd">        metric (object):</span>
<span class="sd">            An evaluation metric object that has an `evaluate` method.</span>
<span class="sd">            This metric will be used to evaluate the model&#39;s performance on the test dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of two data frames.</span>
<span class="sd">        The first one contains evaluation metrics for each window.</span>
<span class="sd">        The second one contains the true and predicted values for each observation in the test set.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<span class="sd">        &gt;&gt;&gt; model = LinearRegression()</span>
<span class="sd">        &gt;&gt;&gt; train = pd.DataFrame({&quot;x&quot;: [1, 2, 3], &quot;y&quot;: [2, 4, 6]})</span>
<span class="sd">        &gt;&gt;&gt; test = pd.DataFrame({&quot;x&quot;: [4, 5], &quot;y&quot;: [8, 10]})</span>
<span class="sd">        &gt;&gt;&gt; df_eval, df_true = eval_bml_horizon(model, train, test, &quot;y&quot;, horizon=1)</span>
<span class="sd">        &gt;&gt;&gt; print(df_eval)</span>
<span class="sd">              Metric  Memory (MB)  CompTime (s)</span>
<span class="sd">        0  0.000000          0.0           0.0</span>
<span class="sd">        1  0.000000          0.0           0.0</span>
<span class="sd">        ...        ...          ...           ...</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if metric is None or null and raise ValueError if it is</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;metric&#39; parameter must not be None or null.&quot;</span><span class="p">)</span>
    <span class="c1"># Reset index of train and test dataframes</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Initialize lists for predictions and differences</span>
    <span class="n">preds_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">diffs_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Fit the model on the training data</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="c1"># Evaluate the model on empty arrays to get initial resource usage</span>
    <span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
        <span class="p">[</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="c1"># If include_remainder is False, remove remainder rows from test dataframe</span>
    <span class="k">if</span> <span class="n">include_remainder</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">%</span> <span class="n">horizon</span>
        <span class="k">if</span> <span class="n">remainder</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="o">-</span><span class="n">remainder</span><span class="p">]</span>
    <span class="c1"># Evaluate the model on batches of size horizon from the test dataframe</span>
    <span class="k">for</span> <span class="n">batch_number</span><span class="p">,</span> <span class="n">batch_df</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span> <span class="o">//</span> <span class="n">horizon</span><span class="p">):</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">batch_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">batch_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">])</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">batch_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">preds</span>
        <span class="n">df_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">batch_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="n">evaluate_model</span><span class="p">(</span>
                <span class="n">y_true</span><span class="o">=</span><span class="n">batch_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">],</span>
                <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span>
                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Append predictions and differences to their respective lists</span>
        <span class="n">preds_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
        <span class="n">diffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
    <span class="c1"># Concatenate predictions and differences lists into series</span>
    <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">preds_list</span><span class="p">))</span>
    <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">diffs_list</span><span class="p">))</span>
    <span class="c1"># Create a dataframe with true values and add columns for predictions and differences</span>
    <span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_preds</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diffs</span>
    <span class="k">return</span> <span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.eval_bml_landmark" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eval_bml_landmark</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.eval_bml_landmark" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate a machine learning model on a rolling landmark basis.</p>
<p>This function evaluates a machine learning model on a rolling landmark basis.
The model is trained on the training data and then evaluated on the test data
using a given evaluation metric. The evaluation results are returned as a tuple
of two data frames. The first one contains evaluation metrics for each window.
The second one contains the true and predicted values for each observation in the test set.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The model to be evaluated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>train</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The training data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>test</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The testing data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column containing the target variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of steps ahead to forecast.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_remainder</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include the remainder of the test dataframe if its length is not divisible by the horizon. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An evaluation metric object that has an <code>evaluate</code> method.
This metric will be used to evaluate the model&rsquo;s performance on the test dataset.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of two data frames. The first one contains evaluation metrics for each window.
The second one contains the true and predicted values for each observation in the test set.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span> <span class="o">=</span> <span class="n">eval_bml_landmark</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df_eval</span><span class="p">)</span>
<span class="go">        Metric  Memory (MB)  CompTime (s)</span>
<span class="go">0  0.000000          0.0           0.0</span>
<span class="go">1  0.000000          0.0           0.0</span>
<span class="go">...        ...          ...           ...</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_bml_landmark</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate a machine learning model on a rolling landmark basis.</span>

<span class="sd">    This function evaluates a machine learning model on a rolling landmark basis.</span>
<span class="sd">    The model is trained on the training data and then evaluated on the test data</span>
<span class="sd">    using a given evaluation metric. The evaluation results are returned as a tuple</span>
<span class="sd">    of two data frames. The first one contains evaluation metrics for each window.</span>
<span class="sd">    The second one contains the true and predicted values for each observation in the test set.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (object): The model to be evaluated.</span>
<span class="sd">        train (pd.DataFrame): The training data set.</span>
<span class="sd">        test (pd.DataFrame): The testing data set.</span>
<span class="sd">        target_column (str): The name of the column containing the target variable.</span>
<span class="sd">        horizon (int, optional): The number of steps ahead to forecast.</span>
<span class="sd">        include_remainder (bool): Whether to include the remainder of the test dataframe if its length is not divisible by the horizon. Defaults to True.</span>
<span class="sd">        metric (object):</span>
<span class="sd">            An evaluation metric object that has an `evaluate` method.</span>
<span class="sd">            This metric will be used to evaluate the model&#39;s performance on the test dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple:</span>
<span class="sd">            A tuple of two data frames. The first one contains evaluation metrics for each window.</span>
<span class="sd">            The second one contains the true and predicted values for each observation in the test set.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<span class="sd">        &gt;&gt;&gt; model = LinearRegression()</span>
<span class="sd">        &gt;&gt;&gt; train = pd.DataFrame({&quot;x&quot;: [1, 2, 3], &quot;y&quot;: [2, 4, 6]})</span>
<span class="sd">        &gt;&gt;&gt; test = pd.DataFrame({&quot;x&quot;: [4, 5], &quot;y&quot;: [8, 10]})</span>
<span class="sd">        &gt;&gt;&gt; df_eval, df_true = eval_bml_landmark(model, train, test, &quot;y&quot;, horizon=1)</span>
<span class="sd">        &gt;&gt;&gt; print(df_eval)</span>
<span class="sd">                Metric  Memory (MB)  CompTime (s)</span>
<span class="sd">        0  0.000000          0.0           0.0</span>
<span class="sd">        1  0.000000          0.0           0.0</span>
<span class="sd">        ...        ...          ...           ...</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
        <span class="p">[</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">include_remainder</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">rem</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">%</span> <span class="n">horizon</span>
        <span class="k">if</span> <span class="n">rem</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="o">-</span><span class="n">rem</span><span class="p">]</span>
    <span class="c1"># Landmark Evaluation</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gen_sliding_window</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)):</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">new_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">new_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">]))</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">preds</span>
        <span class="n">df_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="n">evaluate_model</span><span class="p">(</span>
                <span class="n">y_true</span><span class="o">=</span><span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">],</span>
                <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span>
                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_preds</span><span class="p">,</span> <span class="n">preds</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_diffs</span><span class="p">,</span> <span class="n">diffs</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_preds</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diffs</span>
    <span class="k">return</span> <span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.eval_bml_window" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eval_bml_window</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.eval_bml_window" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate a model on a rolling window basis.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The model to be evaluated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>train</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The training data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>test</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The testing data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column containing the target variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of steps ahead to forecast.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of two data frames. The first one contains evaluation metrics for each window.</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The second one contains the true and predicted values for each observation in the test set.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span> <span class="o">=</span> <span class="n">eval_bml_window</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df_eval</span><span class="p">)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_bml_window</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate a model on a rolling window basis.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (object): The model to be evaluated.</span>
<span class="sd">        train (pd.DataFrame): The training data set.</span>
<span class="sd">        test (pd.DataFrame): The testing data set.</span>
<span class="sd">        target_column (str): The name of the column containing the target variable.</span>
<span class="sd">        horizon (int, optional): The number of steps ahead to forecast.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of two data frames. The first one contains evaluation metrics for each window.</span>
<span class="sd">        The second one contains the true and predicted values for each observation in the test set.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<span class="sd">        &gt;&gt;&gt; model = LinearRegression()</span>
<span class="sd">        &gt;&gt;&gt; train = pd.DataFrame({&quot;x&quot;: [1, 2, 3], &quot;y&quot;: [2, 4, 6]})</span>
<span class="sd">        &gt;&gt;&gt; test = pd.DataFrame({&quot;x&quot;: [4, 5], &quot;y&quot;: [8, 10]})</span>
<span class="sd">        &gt;&gt;&gt; df_eval, df_true = eval_bml_window(model, train, test, &quot;y&quot;, horizon=1)</span>
<span class="sd">        &gt;&gt;&gt; print(df_eval)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
        <span class="p">[</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">include_remainder</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">rem</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">%</span> <span class="n">horizon</span>
        <span class="k">if</span> <span class="n">rem</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="o">-</span><span class="n">rem</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">w_train</span><span class="p">,</span> <span class="n">w_test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gen_horizon_shifted_window</span><span class="p">(</span><span class="n">df_all</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="n">horizon</span><span class="p">)):</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">w_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">w_train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">w_train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">w_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">w_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">]))</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">w_test</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">preds</span>
        <span class="n">df_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="n">evaluate_model</span><span class="p">(</span>
                <span class="n">y_true</span><span class="o">=</span><span class="n">w_test</span><span class="p">[</span><span class="n">target_column</span><span class="p">],</span>
                <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span>
                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_preds</span><span class="p">,</span> <span class="n">preds</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_diffs</span><span class="p">,</span> <span class="n">diffs</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_preds</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diffs</span>
    <span class="k">return</span> <span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.eval_oml_horizon" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eval_oml_horizon</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oml_grace_period</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate an online machine learning model on a rolling horizon basis using
evaluations from batch-machine learning.</p>
<p>This function evaluates an online-machine learning model on a rolling horizon basis.
The model is trained on the training data and then evaluated on the test data
using a given evaluation metric. The evaluation results are returned as a tuple
of two data frames. The first one contains evaluation metrics for each window.
The second one contains the true and predicted values for each observation in the test set.</p>

<details class="notes" open>
  <summary>Notes</summary>
  <p>First, the model is trained on the (small) training data set. No predictions
are made during this initial training phase, but the memory and computation
time are measured. Then, the model is evaluated on the test data set using a
given (sklearn) evaluation metric.
The evaluation results are returned as a tuple of two data frames.</p>
</details>


  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The model to be evaluated. For example, a linear_model from river.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>train</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The training data set. Should be small compared to the test data set.
See also oml_grace_period below.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>test</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The testing data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column containing the target variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of steps ahead to forecast. If set to 1, the model is evaluated and updated
incrementally on the next observation in the test set. If set to 2, the model is evaluated
and updated incrementally on the next two observations in the test set, and so on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_remainder</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include the remainder of the test dataframe if its
length is not divisible by the horizon. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An evaluation metric object that has an <code>evaluate</code> method.
This metric will be used to evaluate the model&rsquo;s performance on the test dataset. Metrics
from sklearn, e.g., mean_absolute_error can be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>oml_grace_period</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of observations to use for (initial) training. Defaults to None,
in which case the horizon is used. Important: Not the entire training set is used
for initial training, but only the last oml_grace_period observations. This is
to simulate the online setting, where the model is trained on a small subset of
the training data set. If None, the horizon is used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of two data frames.
The first one contains evaluation metrics for each window.
The second one contains the true and predicted values for each observation
in the test set.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">river</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="go">    from river import preprocessing</span>
<span class="go">    from sklearn.metrics import mean_absolute_error</span>
<span class="go">    from spotRiver.evaluation.eval.bml import eval_oml_horizon</span>
<span class="go">    model = (</span>
<span class="go">            preprocessing.StandardScaler() |</span>
<span class="go">            linear_model.LinearRegression(intercept_lr=.5)</span>
<span class="go">        )</span>
<span class="go">    horizon = 10</span>
<span class="go">    train = pd.DataFrame({&quot;x&quot;: np.arange(1, 11), &quot;y&quot;: np.arange(2, 22, 2)})</span>
<span class="go">    test = pd.DataFrame({&quot;x&quot;: np.arange(11, 111), &quot;y&quot;: np.arange(22, 222, 2)})</span>
<span class="go">    target_column = &quot;y&quot;</span>
<span class="go">    eval_oml_horizon(</span>
<span class="go">        model = model,</span>
<span class="go">        train = train,</span>
<span class="go">        test = test,</span>
<span class="go">        target_column = target_column,</span>
<span class="go">        horizon = horizon,</span>
<span class="go">        include_remainder = True,</span>
<span class="go">        metric = metric,</span>
<span class="go">        oml_grace_period = horizon,</span>
<span class="go">    )</span>
<span class="go">    (      Metric  Memory (MB)  CompTime (s)</span>
<span class="go">    0        NaN     0.025515      0.001253</span>
<span class="go">    1   1.721100     0.009296      0.001499</span>
<span class="go">    2   1.700408     0.007614      0.000801</span>
<span class="go">    3   1.690827     0.007833      0.002240</span>
<span class="go">    4   1.685174     0.007614      0.000784</span>
<span class="go">    5   1.681406     0.007614      0.000738</span>
<span class="go">    6   1.678697     0.007937      0.001930</span>
<span class="go">    7   1.676648     0.007614      0.000782</span>
<span class="go">    8   1.675039     0.007431      0.000760</span>
<span class="go">    9   1.673739     0.007431      0.000687</span>
<span class="go">    10  1.672665     0.007431      0.000678,</span>
<span class="go">        y  Prediction  Difference</span>
<span class="go">    0    22   20.261831    1.738169</span>
<span class="go">    1    24   22.267027    1.732973</span>
<span class="go">    2    26   24.271507    1.728493</span>
<span class="go">    3    28   26.275414    1.724586</span>
<span class="go">    4    30   28.278854    1.721146</span>
<span class="go">    ..  ...         ...         ...</span>
<span class="go">    95  212  210.327390    1.672610</span>
<span class="go">    96  214  212.327487    1.672513</span>
<span class="go">    97  216  214.327581    1.672419</span>
<span class="go">    98  218  216.327674    1.672326</span>
<span class="go">    99  220  218.327766    1.672234</span>
</code></pre></div>
    <pre><code>[100 rows x 3 columns])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_oml_horizon</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">oml_grace_period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate an online machine learning model on a rolling horizon basis using</span>
<span class="sd">    evaluations from batch-machine learning.</span>

<span class="sd">    This function evaluates an online-machine learning model on a rolling horizon basis.</span>
<span class="sd">    The model is trained on the training data and then evaluated on the test data</span>
<span class="sd">    using a given evaluation metric. The evaluation results are returned as a tuple</span>
<span class="sd">    of two data frames. The first one contains evaluation metrics for each window.</span>
<span class="sd">    The second one contains the true and predicted values for each observation in the test set.</span>

<span class="sd">    Notes:</span>
<span class="sd">        First, the model is trained on the (small) training data set. No predictions</span>
<span class="sd">        are made during this initial training phase, but the memory and computation</span>
<span class="sd">        time are measured. Then, the model is evaluated on the test data set using a</span>
<span class="sd">        given (sklearn) evaluation metric.</span>
<span class="sd">        The evaluation results are returned as a tuple of two data frames.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (object):</span>
<span class="sd">            The model to be evaluated. For example, a linear_model from river.</span>
<span class="sd">        train (pd.DataFrame):</span>
<span class="sd">            The training data set. Should be small compared to the test data set.</span>
<span class="sd">            See also oml_grace_period below.</span>
<span class="sd">        test (pd.DataFrame):</span>
<span class="sd">            The testing data set.</span>
<span class="sd">        target_column (str):</span>
<span class="sd">            The name of the column containing the target variable.</span>
<span class="sd">        horizon (int, optional):</span>
<span class="sd">            The number of steps ahead to forecast. If set to 1, the model is evaluated and updated</span>
<span class="sd">            incrementally on the next observation in the test set. If set to 2, the model is evaluated</span>
<span class="sd">            and updated incrementally on the next two observations in the test set, and so on.</span>
<span class="sd">        include_remainder (bool):</span>
<span class="sd">            Whether to include the remainder of the test dataframe if its</span>
<span class="sd">            length is not divisible by the horizon. Defaults to True.</span>
<span class="sd">        metric (object):</span>
<span class="sd">            An evaluation metric object that has an `evaluate` method.</span>
<span class="sd">            This metric will be used to evaluate the model&#39;s performance on the test dataset. Metrics</span>
<span class="sd">            from sklearn, e.g., mean_absolute_error can be used.</span>
<span class="sd">        oml_grace_period (int, optional):</span>
<span class="sd">            The number of observations to use for (initial) training. Defaults to None,</span>
<span class="sd">            in which case the horizon is used. Important: Not the entire training set is used</span>
<span class="sd">            for initial training, but only the last oml_grace_period observations. This is</span>
<span class="sd">            to simulate the online setting, where the model is trained on a small subset of</span>
<span class="sd">            the training data set. If None, the horizon is used.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple:</span>
<span class="sd">            A tuple of two data frames.</span>
<span class="sd">            The first one contains evaluation metrics for each window.</span>
<span class="sd">            The second one contains the true and predicted values for each observation</span>
<span class="sd">            in the test set.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from river import linear_model</span>
<span class="sd">            from river import preprocessing</span>
<span class="sd">            from sklearn.metrics import mean_absolute_error</span>
<span class="sd">            from spotRiver.evaluation.eval.bml import eval_oml_horizon</span>
<span class="sd">            model = (</span>
<span class="sd">                    preprocessing.StandardScaler() |</span>
<span class="sd">                    linear_model.LinearRegression(intercept_lr=.5)</span>
<span class="sd">                )</span>
<span class="sd">            horizon = 10</span>
<span class="sd">            train = pd.DataFrame({&quot;x&quot;: np.arange(1, 11), &quot;y&quot;: np.arange(2, 22, 2)})</span>
<span class="sd">            test = pd.DataFrame({&quot;x&quot;: np.arange(11, 111), &quot;y&quot;: np.arange(22, 222, 2)})</span>
<span class="sd">            target_column = &quot;y&quot;</span>
<span class="sd">            eval_oml_horizon(</span>
<span class="sd">                model = model,</span>
<span class="sd">                train = train,</span>
<span class="sd">                test = test,</span>
<span class="sd">                target_column = target_column,</span>
<span class="sd">                horizon = horizon,</span>
<span class="sd">                include_remainder = True,</span>
<span class="sd">                metric = metric,</span>
<span class="sd">                oml_grace_period = horizon,</span>
<span class="sd">            )</span>
<span class="sd">            (      Metric  Memory (MB)  CompTime (s)</span>
<span class="sd">            0        NaN     0.025515      0.001253</span>
<span class="sd">            1   1.721100     0.009296      0.001499</span>
<span class="sd">            2   1.700408     0.007614      0.000801</span>
<span class="sd">            3   1.690827     0.007833      0.002240</span>
<span class="sd">            4   1.685174     0.007614      0.000784</span>
<span class="sd">            5   1.681406     0.007614      0.000738</span>
<span class="sd">            6   1.678697     0.007937      0.001930</span>
<span class="sd">            7   1.676648     0.007614      0.000782</span>
<span class="sd">            8   1.675039     0.007431      0.000760</span>
<span class="sd">            9   1.673739     0.007431      0.000687</span>
<span class="sd">            10  1.672665     0.007431      0.000678,</span>
<span class="sd">                y  Prediction  Difference</span>
<span class="sd">            0    22   20.261831    1.738169</span>
<span class="sd">            1    24   22.267027    1.732973</span>
<span class="sd">            2    26   24.271507    1.728493</span>
<span class="sd">            3    28   26.275414    1.724586</span>
<span class="sd">            4    30   28.278854    1.721146</span>
<span class="sd">            ..  ...         ...         ...</span>
<span class="sd">            95  212  210.327390    1.672610</span>
<span class="sd">            96  214  212.327487    1.672513</span>
<span class="sd">            97  216  214.327581    1.672419</span>
<span class="sd">            98  218  216.327674    1.672326</span>
<span class="sd">            99  220  218.327766    1.672234</span>

<span class="sd">            [100 rows x 3 columns])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if metric is None or null and raise ValueError if it is</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;metric&#39; parameter must not be None or null.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oml_grace_period</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oml_grace_period</span> <span class="o">=</span> <span class="n">horizon</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_remainder</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">rem</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">%</span> <span class="n">horizon</span>
        <span class="k">if</span> <span class="n">rem</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="o">-</span><span class="n">rem</span><span class="p">]</span>

    <span class="c1"># Fit the model on the train data, i.e., initial Training on Train Data.</span>
    <span class="c1"># This is performed on a limited subset only (oml_grace_period).</span>
    <span class="c1"># No predictions are made here, only the model is fitted.</span>
    <span class="c1"># Memory and runtime are measured for the model fitting</span>
    <span class="n">train_X</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">]</span>
    <span class="n">train_y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span>
    <span class="n">train_X</span> <span class="o">=</span> <span class="n">train_X</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">oml_grace_period</span><span class="p">)</span>
    <span class="n">train_y</span> <span class="o">=</span> <span class="n">train_y</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">oml_grace_period</span><span class="p">)</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">river_stream</span><span class="o">.</span><span class="n">iter_pandas</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">):</span>
            <span class="c1"># Before v0.19 we had to call predict_one before learn_one</span>
            <span class="c1"># in order for the whole pipeline to be updated.</span>
            <span class="c1"># Since v0.19, calling learn_one in a pipeline will update each part</span>
            <span class="c1"># of the pipeline in turn.</span>
            <span class="c1"># Before v0.19, predict_one has to be called for updating the unsupervised parts</span>
            <span class="c1"># of the pipeline.</span>
            <span class="c1"># The following line, which returns y_pred, which is not used after v0.19:</span>
            <span class="c1"># _ = model.predict_one(xi)</span>
            <span class="c1"># model = model.learn_one(xi, yi)</span>
            <span class="c1"># Starting with 0.21.0, the learn_one and learn_many methods of each estimator don&#39;t not </span>
            <span class="c1"># return anything anymore.</span>
            <span class="c1"># This is to emphasize that the estimators are stateful.</span>
            <span class="n">model</span><span class="o">.</span><span class="n">learn_one</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>

    <span class="c1"># Create empty lists to collect data</span>
    <span class="n">eval_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">series_preds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">series_diffs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Measure the costs of the initial training:</span>
    <span class="c1"># Add the evaluation of the model (memory and time, not predictions) on the train data to the eval_data list</span>
    <span class="c1"># A metric must not be passed to the evaluate_model function, because no predictions are made here</span>
    <span class="c1"># If a metric is passed, it will be ignored, because no predictions are passed to the evaluation function</span>
    <span class="c1"># So, metric=None and metric=mean_absolute_error will both work</span>
    <span class="c1"># Return res_dict = {&quot;Metric&quot;: score, &quot;Memory (MB)&quot;: memory, &quot;CompTime (s)&quot;: r_time}</span>
    <span class="n">eval_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Test Data Evaluation</span>
    <span class="c1"># A sliding window of length horizon is used to evaluate the model on the test data</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gen_sliding_window</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)):</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">test_X</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">new_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">]</span>
        <span class="n">test_y</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">river_stream</span><span class="o">.</span><span class="n">iter_pandas</span><span class="p">(</span><span class="n">test_X</span><span class="p">,</span> <span class="n">test_y</span><span class="p">):</span>
                <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_one</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
                <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
                <span class="c1"># model = model.learn_one(xi, yi)</span>
                <span class="c1"># Starting with 0.21.0, the learn_one and learn_many methods of each estimator don&#39;t not</span>
                <span class="c1"># return anything anymore.</span>
                <span class="c1"># This is to emphasize that the estimators are stateful.</span>
                <span class="n">model</span><span class="o">.</span><span class="n">learn_one</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">preds</span>

        <span class="c1"># Collect data in lists</span>
        <span class="n">eval_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">evaluate_model</span><span class="p">(</span>
                <span class="n">y_true</span><span class="o">=</span><span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">],</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">series_preds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
        <span class="n">series_diffs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>

    <span class="c1"># Create DataFrames from the collected data</span>
    <span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">eval_data</span><span class="p">)</span>
    <span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_preds</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diffs</span>
    <span class="k">return</span> <span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.evaluate_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.evaluate_model" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate a machine learning model on a test dataset.</p>
<p>This function evaluates a machine learning model on a test dataset using a given evaluation metric.
The evaluation results are returned as a dictionary.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y_true</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A numpy array containing the true values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_pred</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A numpy array containing the predicted values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>memory</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The memory usage of the model.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>r_time</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The computation time of the model.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An evaluation metric object that has an <code>evaluate</code> method.
This metric will be used to evaluate the model&rsquo;s performance on the test dataset.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary containing the evaluation results.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">memory</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_time</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metric</span> <span class="o">=</span> <span class="n">accuracy_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span>
<span class="go">{&#39;Metric&#39;: 0.75, &#39;Memory (MB)&#39;: 0.0, &#39;CompTime (s)&#39;: 0.0}</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">memory</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">r_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate a machine learning model on a test dataset.</span>

<span class="sd">    This function evaluates a machine learning model on a test dataset using a given evaluation metric.</span>
<span class="sd">    The evaluation results are returned as a dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        y_true (np.ndarray): A numpy array containing the true values.</span>
<span class="sd">        y_pred (np.ndarray): A numpy array containing the predicted values.</span>
<span class="sd">        memory (float): The memory usage of the model.</span>
<span class="sd">        r_time (float): The computation time of the model.</span>
<span class="sd">        metric (object): An evaluation metric object that has an `evaluate` method.</span>
<span class="sd">            This metric will be used to evaluate the model&#39;s performance on the test dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the evaluation results.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.metrics import accuracy_score</span>
<span class="sd">        &gt;&gt;&gt; y_true = np.array([0, 1, 0, 1])</span>
<span class="sd">        &gt;&gt;&gt; y_pred = np.array([0, 1, 1, 1])</span>
<span class="sd">        &gt;&gt;&gt; memory = 0.0</span>
<span class="sd">        &gt;&gt;&gt; r_time = 0.0</span>
<span class="sd">        &gt;&gt;&gt; metric = accuracy_score</span>
<span class="sd">        &gt;&gt;&gt; evaluate_model(y_true, y_pred, memory, r_time, metric)</span>
<span class="sd">        {&#39;Metric&#39;: 0.75, &#39;Memory (MB)&#39;: 0.0, &#39;CompTime (s)&#39;: 0.0}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_true and y_pred must have the same size&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">res_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">:</span> <span class="n">memory</span><span class="p">,</span>
            <span class="s2">&quot;CompTime (s)&quot;</span><span class="p">:</span> <span class="n">r_time</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">res_dict</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">metric</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">res_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">,</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">:</span> <span class="n">memory</span><span class="p">,</span> <span class="s2">&quot;CompTime (s)&quot;</span><span class="p">:</span> <span class="n">r_time</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">res_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.gen_sliding_window" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">gen_sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.gen_sliding_window" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Generates sliding windows of a given size from a DataFrame.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input DataFrame.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the sliding window.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_remainder</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include the remainder of the DataFrame
if its length is not divisible by the horizon. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Yields:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A sliding window of the input DataFrame.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">gen_sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
<span class="go">   A  B</span>
<span class="go">0  1  4</span>
<span class="go">1  2  5</span>
<span class="go">   A  B</span>
<span class="go">2  3  6</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gen_sliding_window</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates sliding windows of a given size from a DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The input DataFrame.</span>
<span class="sd">        horizon (int): The size of the sliding window.</span>
<span class="sd">        include_remainder (bool):</span>
<span class="sd">            Whether to include the remainder of the DataFrame</span>
<span class="sd">            if its length is not divisible by the horizon. Defaults to False.</span>

<span class="sd">    Yields:</span>
<span class="sd">        (pd.DataFrame):</span>
<span class="sd">            A sliding window of the input DataFrame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({&#39;A&#39;: [1, 2, 3], &#39;B&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; for window in gen_sliding_window(df, 2):</span>
<span class="sd">        ...     print(window)</span>
<span class="sd">           A  B</span>
<span class="sd">        0  1  4</span>
<span class="sd">        1  2  5</span>
<span class="sd">           A  B</span>
<span class="sd">        2  3  6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">horizon</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">horizon</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">include_remainder</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">subset</span>
            <span class="k">break</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">yield</span> <span class="n">subset</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_bml_oml_horizon_metrics</span><span class="p">(</span><span class="n">df_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Plot evaluation metrics for machine learning models.</p>
<p>This function plots the evaluation metrics for different machine learning models
on a given dataset. The function takes a list of pandas dataframes as input,
each containing the evaluation metrics for one model. The function also takes
an optional list of labels for each model and boolean flags to indicate whether
to use logarithmic scales for the x-axis and y-axis.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_eval</code></td>
          <td>
                <code>list[<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of pandas dataframes containing the evaluation metrics for each model.
Each dataframe should have an index column with the dataset name and three
columns with the label names: e.g., &ldquo;Metric&rdquo;, &ldquo;CompTime (s)&rdquo; and &ldquo;Memory (MB)&rdquo;.
If None, no plot is generated. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>df_labels</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of strings containing the labels for each model.
The length of this list should match the length of df_eval.
If None, numeric indices are used as labels. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>log_x</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A flag indicating whether to use logarithmic scale for the x-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>log_y</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A flag indicating whether to use logarithmic scale for the y-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>cumulative</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A flag indicating whether to plot cumulative metrics.
If True, cumulative metrics are plotted. If False, non-cumulative metrics are plotted.
Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>grid</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A flag indicating whether to plot a grid.
If True, grid is shown. Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the figure. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>metric</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An evaluation metric object that has an <code>evaluate</code> method.
This metric will be used to evaluate the model&rsquo;s performance on the test dataset.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file to save the plot to. If None, the plot is not saved. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code>Any</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments to be passed to the plot function.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>NoneType</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This function does not return anything.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotRiver.evaluation.eval_bml</span> <span class="kn">import</span> <span class="n">plot_bml_oml_horizon_metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> <span class="s2">&quot;CompTime (s)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Model 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Model 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Model 3&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_bml_oml_horizon_metrics</span><span class="p">(</span><span class="n">df_eval</span><span class="p">,</span> <span class="n">df_labels</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">accuracy_score</span><span class="p">)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_bml_oml_horizon_metrics</span><span class="p">(</span>
    <span class="n">df_eval</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">df_labels</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot evaluation metrics for machine learning models.</span>

<span class="sd">    This function plots the evaluation metrics for different machine learning models</span>
<span class="sd">    on a given dataset. The function takes a list of pandas dataframes as input,</span>
<span class="sd">    each containing the evaluation metrics for one model. The function also takes</span>
<span class="sd">    an optional list of labels for each model and boolean flags to indicate whether</span>
<span class="sd">    to use logarithmic scales for the x-axis and y-axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_eval (list[pd.DataFrame], optional):</span>
<span class="sd">            A list of pandas dataframes containing the evaluation metrics for each model.</span>
<span class="sd">            Each dataframe should have an index column with the dataset name and three</span>
<span class="sd">            columns with the label names: e.g., &quot;Metric&quot;, &quot;CompTime (s)&quot; and &quot;Memory (MB)&quot;.</span>
<span class="sd">            If None, no plot is generated. Default is None.</span>
<span class="sd">        df_labels (list, optional):</span>
<span class="sd">            A list of strings containing the labels for each model.</span>
<span class="sd">            The length of this list should match the length of df_eval.</span>
<span class="sd">            If None, numeric indices are used as labels. Default is None.</span>
<span class="sd">        log_x (bool, optional):</span>
<span class="sd">            A flag indicating whether to use logarithmic scale for the x-axis.</span>
<span class="sd">            If True, log scale is used. If False, linear scale is used. Default is False.</span>
<span class="sd">        log_y (bool, optional):</span>
<span class="sd">            A flag indicating whether to use logarithmic scale for the y-axis.</span>
<span class="sd">            If True, log scale is used. If False, linear scale is used. Default is False.</span>
<span class="sd">        cumulative (bool, optional):</span>
<span class="sd">            A flag indicating whether to plot cumulative metrics.</span>
<span class="sd">            If True, cumulative metrics are plotted. If False, non-cumulative metrics are plotted.</span>
<span class="sd">            Default is True.</span>
<span class="sd">        grid (bool, optional):</span>
<span class="sd">            A flag indicating whether to plot a grid.</span>
<span class="sd">            If True, grid is shown. Default is True.</span>
<span class="sd">        figsize (tuple, optional):</span>
<span class="sd">            The size of the figure. Default is None.</span>
<span class="sd">        metric (object):</span>
<span class="sd">            An evaluation metric object that has an `evaluate` method.</span>
<span class="sd">            This metric will be used to evaluate the model&#39;s performance on the test dataset.</span>
<span class="sd">        filename (str, optional):</span>
<span class="sd">            The name of the file to save the plot to. If None, the plot is not saved. Default is None.</span>
<span class="sd">        **kwargs (Any): Additional keyword arguments to be passed to the plot function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): This function does not return anything.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.metrics import accuracy_score</span>
<span class="sd">        &gt;&gt;&gt; from spotRiver.evaluation.eval_bml import plot_bml_oml_horizon_metrics</span>
<span class="sd">        &gt;&gt;&gt; df_eval = pd.DataFrame({&quot;Metric&quot;: [0.5, 0.75, 0.9], &quot;CompTime (s)&quot;: [0.1, 0.2, 0.3], &quot;Memory (MB)&quot;: [0.1, 0.2, 0.3]})</span>
<span class="sd">        &gt;&gt;&gt; df_labels = [&quot;Model 1&quot;, &quot;Model 2&quot;, &quot;Model 3&quot;]</span>
<span class="sd">        &gt;&gt;&gt; plot_bml_oml_horizon_metrics(df_eval, df_labels, metric=accuracy_score)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="c1"># Check if metric is None or null and raise ValueError if it is</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;metric&#39; parameter must not be None or null.&quot;</span><span class="p">)</span>
    <span class="c1"># Check if input dataframes are provided</span>
    <span class="k">if</span> <span class="n">df_eval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">df_eval</span><span class="p">)</span>
        <span class="c1"># Convert single dataframe input to a list if needed</span>
        <span class="k">if</span> <span class="n">df_list</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_list</span><span class="p">]</span>
        <span class="c1"># Define metric names and titles</span>
        <span class="n">metric_name</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">,</span> <span class="s2">&quot;CompTime (s)&quot;</span><span class="p">,</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">metric_name</span><span class="p">,</span> <span class="s2">&quot;Computation time (s)&quot;</span><span class="p">,</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">]</span>
        <span class="c1"># Create subplots with shared x-axis</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Loop over each dataframe in input list</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
                <span class="c1"># df.MAE = np.cumsum(df.MAE) / range(1, (1 + df.MAE.size))</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;CompTime (s)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;CompTime (s)&quot;</span><span class="p">])</span>  <span class="c1"># / range(1, (1 + df[&quot;CompTime (s)&quot;].size))</span>
                <span class="c1"># df[&quot;Memory (MB)&quot;] = np.cumsum(df[&quot;Memory (MB)&quot;]) / range(1, (1 + df[&quot;Memory (MB)&quot;].size))</span>
            <span class="c1"># Loop over each metric</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="c1"># Assign label based on input or default value</span>
                <span class="k">if</span> <span class="n">df_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">df_labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># Plot metric values against dataset names</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">metrics</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="c1"># Set title and legend</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
                <span class="c1"># Set logarithmic scales if specified</span>
                <span class="k">if</span> <span class="n">log_x</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">log_y</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_bml_oml_horizon_predictions</span><span class="p">(</span><span class="n">df_true</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_column</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_first_n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Plot actual vs predicted values for machine learning models.</p>
<p>This function plots the actual vs predicted values for different machine learning models
on a given dataset. The function takes a list of pandas dataframes as input,
each containing the actual and predicted values for one model. The function also takes
an optional list of labels for each model and boolean flags to indicate whether
to use logarithmic scales for the x-axis and y-axis.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_true</code></td>
          <td>
                <code>list[<span title="pandas.DataFrame">DataFrame</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of pandas dataframes containing the actual and predicted values for each model.
Each dataframe should have an index column with the dataset name and two columns with
the label names: e.g., &ldquo;Actual&rdquo; and &ldquo;Prediction&rdquo;.
If None, no plot is generated. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>df_labels</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of strings containing the labels for each model.
The length of this list should match the length of df_true.
If None, numeric indices are used as labels. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>target_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column containing the target variable. Default is &ldquo;Actual&rdquo;.</p>
            </div>
          </td>
          <td>
                <code>&#39;Actual&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>log_x</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A flag indicating whether to use logarithmic scale for the x-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>log_y</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A flag indicating whether to use logarithmic scale for the y-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>skip_first_n</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of rows to skip from the beginning of the dataframes. Default is 0.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>grid</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A flag indicating whether to plot a grid. If True, grid is shown. Default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the figure. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>filename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the file to save the plot to. If None, the plot is not saved. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code>Any</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional keyword arguments to be passed to the plot function.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>NoneType</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This function does not return anything.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spotRiver.evaluation.eval_bml</span> <span class="kn">import</span> <span class="n">plot_bml_oml_horizon_predictions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Actual&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span> <span class="s2">&quot;Prediction&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Model 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Model 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Model 3&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_bml_oml_horizon_predictions</span><span class="p">(</span><span class="n">df_true</span><span class="p">,</span> <span class="n">df_labels</span><span class="p">,</span> <span class="n">target_column</span><span class="o">=</span><span class="s2">&quot;Actual&quot;</span><span class="p">)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>spotRiver/evaluation/eval_bml.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_bml_oml_horizon_predictions</span><span class="p">(</span>
    <span class="n">df_true</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">df_labels</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Actual&quot;</span><span class="p">,</span>
    <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_first_n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot actual vs predicted values for machine learning models.</span>

<span class="sd">    This function plots the actual vs predicted values for different machine learning models</span>
<span class="sd">    on a given dataset. The function takes a list of pandas dataframes as input,</span>
<span class="sd">    each containing the actual and predicted values for one model. The function also takes</span>
<span class="sd">    an optional list of labels for each model and boolean flags to indicate whether</span>
<span class="sd">    to use logarithmic scales for the x-axis and y-axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_true (list[pd.DataFrame], optional):</span>
<span class="sd">            A list of pandas dataframes containing the actual and predicted values for each model.</span>
<span class="sd">            Each dataframe should have an index column with the dataset name and two columns with</span>
<span class="sd">            the label names: e.g., &quot;Actual&quot; and &quot;Prediction&quot;.</span>
<span class="sd">            If None, no plot is generated. Default is None.</span>
<span class="sd">        df_labels (list, optional):</span>
<span class="sd">            A list of strings containing the labels for each model.</span>
<span class="sd">            The length of this list should match the length of df_true.</span>
<span class="sd">            If None, numeric indices are used as labels. Default is None.</span>
<span class="sd">        target_column (str, optional):</span>
<span class="sd">            The name of the column containing the target variable. Default is &quot;Actual&quot;.</span>
<span class="sd">        log_x (bool, optional):</span>
<span class="sd">            A flag indicating whether to use logarithmic scale for the x-axis.</span>
<span class="sd">            If True, log scale is used. If False, linear scale is used. Default is False.</span>
<span class="sd">        log_y (bool, optional):</span>
<span class="sd">            A flag indicating whether to use logarithmic scale for the y-axis.</span>
<span class="sd">            If True, log scale is used. If False, linear scale is used. Default is False.</span>
<span class="sd">        skip_first_n (int, optional):</span>
<span class="sd">            The number of rows to skip from the beginning of the dataframes. Default is 0.</span>
<span class="sd">        grid (bool, optional):</span>
<span class="sd">            A flag indicating whether to plot a grid. If True, grid is shown. Default is True.</span>
<span class="sd">        figsize (tuple, optional):</span>
<span class="sd">            The size of the figure. Default is None.</span>
<span class="sd">        filename (str, optional):</span>
<span class="sd">            The name of the file to save the plot to. If None, the plot is not saved. Default is None.</span>
<span class="sd">        **kwargs (Any): Additional keyword arguments to be passed to the plot function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (NoneType): This function does not return anything.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.metrics import accuracy_score</span>
<span class="sd">        &gt;&gt;&gt; from spotRiver.evaluation.eval_bml import plot_bml_oml_horizon_predictions</span>
<span class="sd">        &gt;&gt;&gt; df_true = pd.DataFrame({&quot;Actual&quot;: [0.5, 0.75, 0.9], &quot;Prediction&quot;: [0.1, 0.2, 0.3]})</span>
<span class="sd">        &gt;&gt;&gt; df_labels = [&quot;Model 1&quot;, &quot;Model 2&quot;, &quot;Model 3&quot;]</span>
<span class="sd">        &gt;&gt;&gt; plot_bml_oml_horizon_predictions(df_true, df_labels, target_column=&quot;Actual&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df_true</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_plot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">df_true</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">df_plot</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">df_plot</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_plot</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_plot</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">df_labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span> <span class="n">skip_first_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">target_column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Actual&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Actual vs Prediction&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_x</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_y</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2019 - 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/bartzbeielstein" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/thomas-bartz-beielstein-3157b541/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "navigation.tabs", "navigation.instant", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>