
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://www.spotseven.de/reference/spotRiver/evaluation/eval_bml/">
      
      
        <link rel="prev" href="../../drift/drift_generator/">
      
      
        <link rel="next" href="../eval_nowcast/">
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>eval_bml - spotRiver</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.26e3688c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spotRiver.evaluation.eval_bml" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="spotRiver" class="md-header__button md-logo" aria-label="spotRiver" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotRiver
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              eval_bml
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="spotRiver" class="md-nav__button md-logo" aria-label="spotRiver" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    spotRiver
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../download/" class="md-nav__link">
        Download
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Code Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          spotRiver
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          spotRiver
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../data/">data</a>
          
            <label for="__nav_4_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_1">
          <span class="md-nav__icon md-icon"></span>
          data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/airline_passengers/" class="md-nav__link">
        airline_passengers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/bike_sharing/" class="md-nav__link">
        bike_sharing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/generic/" class="md-nav__link">
        generic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/opm/" class="md-nav__link">
        opm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/river_hyper_dict/" class="md-nav__link">
        river_hyper_dict
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_7" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../data/synth/">synth</a>
          
            <label for="__nav_4_1_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_1_7">
          <span class="md-nav__icon md-icon"></span>
          synth
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/synth/sea/" class="md-nav__link">
        sea
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
          drift
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_2">
          <span class="md-nav__icon md-icon"></span>
          drift
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../drift/drift_generator/" class="md-nav__link">
        drift_generator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4_1_3" id="__nav_4_1_3_label" tabindex="0">
          evaluation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_1_3">
          <span class="md-nav__icon md-icon"></span>
          evaluation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          eval_bml
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        eval_bml
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml" class="md-nav__link">
    spotRiver.evaluation.eval_bml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor" class="md-nav__link">
    ResourceMonitor
  </a>
  
    <nav class="md-nav" aria-label="ResourceMonitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor--attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor--methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_horizon" class="md-nav__link">
    eval_bml_horizon()
  </a>
  
    <nav class="md-nav" aria-label="eval_bml_horizon()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_horizon--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_window" class="md-nav__link">
    eval_bml_window()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon" class="md-nav__link">
    eval_oml_horizon()
  </a>
  
    <nav class="md-nav" aria-label="eval_oml_horizon()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon--examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model" class="md-nav__link">
    evaluate_model()
  </a>
  
    <nav class="md-nav" aria-label="evaluate_model()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.gen_sliding_window" class="md-nav__link">
    gen_sliding_window()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics" class="md-nav__link">
    plot_bml_oml_horizon_metrics()
  </a>
  
    <nav class="md-nav" aria-label="plot_bml_oml_horizon_metrics()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions" class="md-nav__link">
    plot_bml_oml_horizon_predictions()
  </a>
  
    <nav class="md-nav" aria-label="plot_bml_oml_horizon_predictions()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../eval_nowcast/" class="md-nav__link">
        eval_nowcast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../eval_oml/" class="md-nav__link">
        eval_oml
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1_4" id="__nav_4_1_4_label" tabindex="0">
          fun
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_4">
          <span class="md-nav__icon md-icon"></span>
          fun
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hyperriver/" class="md-nav__link">
        hyperriver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fun/hyperriver_old/" class="md-nav__link">
        hyperriver_old
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_5" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1_5" id="__nav_4_1_5_label" tabindex="0">
          plot
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_5">
          <span class="md-nav__icon md-icon"></span>
          plot
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/stats/" class="md-nav__link">
        stats
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_6" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1_6" id="__nav_4_1_6_label" tabindex="0">
          preprocess
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_6">
          <span class="md-nav__icon md-icon"></span>
          preprocess
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocess/impute/" class="md-nav__link">
        impute
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_7" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1_7" id="__nav_4_1_7_label" tabindex="0">
          utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1_7">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/data_conversion/" class="md-nav__link">
        data_conversion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/features/" class="md-nav__link">
        features
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml" class="md-nav__link">
    spotRiver.evaluation.eval_bml
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor" class="md-nav__link">
    ResourceMonitor
  </a>
  
    <nav class="md-nav" aria-label="ResourceMonitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor--attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor--methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.ResourceMonitor--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_horizon" class="md-nav__link">
    eval_bml_horizon()
  </a>
  
    <nav class="md-nav" aria-label="eval_bml_horizon()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_horizon--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_bml_window" class="md-nav__link">
    eval_bml_window()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon" class="md-nav__link">
    eval_oml_horizon()
  </a>
  
    <nav class="md-nav" aria-label="eval_oml_horizon()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.eval_oml_horizon--examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model" class="md-nav__link">
    evaluate_model()
  </a>
  
    <nav class="md-nav" aria-label="evaluate_model()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.evaluate_model--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.gen_sliding_window" class="md-nav__link">
    gen_sliding_window()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics" class="md-nav__link">
    plot_bml_oml_horizon_metrics()
  </a>
  
    <nav class="md-nav" aria-label="plot_bml_oml_horizon_metrics()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions" class="md-nav__link">
    plot_bml_oml_horizon_predictions()
  </a>
  
    <nav class="md-nav" aria-label="plot_bml_oml_horizon_predictions()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>eval_bml</h1>

<div class="doc doc-object doc-module">


<a id="spotRiver.evaluation.eval_bml"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="spotRiver.evaluation.eval_bml.ResourceMonitor" class="doc doc-heading">
        <code>ResourceMonitor</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>A class to monitor resource usage such as memory and time.</p>
<h4 id="spotRiver.evaluation.eval_bml.ResourceMonitor--attributes">Attributes</h4>

<details class="name-" open>
  <summary>str</summary>
  <p>The name of the resource monitor.</p>
</details>
<details class="r_time-" open>
  <summary>float</summary>
  <p>The time taken for the monitored code to execute in seconds.</p>
</details>
<details class="memory-" open>
  <summary>float</summary>
  <p>The peak memory usage during the execution of the monitored code in MB.</p>
</details>      <h4 id="spotRiver.evaluation.eval_bml.ResourceMonitor--methods">Methods</h4>
<p>result():
    Returns a ResourceUsage object containing the name, time and memory usage of the monitored code.</p>
<h4 id="spotRiver.evaluation.eval_bml.ResourceMonitor--example">Example</h4>
<pre><code>&gt;&gt;&gt; rm = ResourceMonitor()
    with rm:
        x = 10 ** 6
    print(rm.result())
    # Output:
    #   Resource usage for None:
    #   Time [s]: 2.917e-06
    #   Memory [b]: 8.7738037109375e-05
</code></pre>


        <details class="quote">
          <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ResourceMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to monitor resource usage such as memory and time.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The name of the resource monitor.</span>
<span class="sd">    r_time : float</span>
<span class="sd">        The time taken for the monitored code to execute in seconds.</span>
<span class="sd">    memory : float</span>
<span class="sd">        The peak memory usage during the execution of the monitored code in MB.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    result():</span>
<span class="sd">        Returns a ResourceUsage object containing the name, time and memory usage of the monitored code.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">        &gt;&gt;&gt; rm = ResourceMonitor()</span>
<span class="sd">            with rm:</span>
<span class="sd">                x = 10 ** 6</span>
<span class="sd">            print(rm.result())</span>
<span class="sd">            # Output:</span>
<span class="sd">            #   Resource usage for None:</span>
<span class="sd">            #   Time [s]: 2.917e-06</span>
<span class="sd">            #   Memory [b]: 8.7738037109375e-05</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_memory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_memory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tracemalloc</span><span class="o">.</span><span class="n">is_tracing</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ResourceMonitorError</span><span class="p">(</span><span class="s2">&quot;Already tracing memory usage!&quot;</span><span class="p">)</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">reset_peak</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter_ns</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e9</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">peak</span> <span class="o">=</span> <span class="n">tracemalloc</span><span class="o">.</span><span class="n">get_traced_memory</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="n">peak</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="n">tracemalloc</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResourceMonitorError</span><span class="p">(</span><span class="s2">&quot;No resources monitored yet.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ResourceUsage</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.eval_bml_horizon" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_bml_horizon</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate a machine learning model on a rolling horizon basis.</p>
<p>This function evaluates a machine learning model on a test dataset by making
predictions on batches of size <code>horizon</code> from the test dataset. The model is
first fit on the training dataset. The evaluation results are returned as a
dataframe along with a dataframe containing the true values, predictions and
differences for each observation in the test dataset.</p>
<h4 id="spotRiver.evaluation.eval_bml.eval_bml_horizon--parameters">Parameters</h4>

<details class="model-" open>
  <summary>object</summary>
  <p>A machine learning model object that has <code>fit</code> and <code>predict</code> methods.</p>
</details>
<details class="train-" open>
  <summary>pd.DataFrame</summary>
  <p>A pandas DataFrame containing the training data. The target column should be included in this dataframe.</p>
</details>      <p>test : pd.DataFrame
     A pandas DataFrame containing the test data. The target column should be included in this dataframe.</p>
<p>target_column : str
     The name of the target column in the train and test dataframes.</p>
<p>horizon : int
     The size of each batch from the test dataframe to make predictions on.</p>
<p>include_remainder : bool, optional (default=True)
     Whether to include remainder rows from the test dataframe when making predictions.
     If False, remainder rows will be removed before making predictions.</p>
<p>metric : object
     An evaluation metric object that has an <code>evaluate</code> method.
     This metric will be used to evaluate the model's performance on each batch from the test dataframe.</p>
<p>Returns</p>
<hr />
<p>tuple of pd.DataFrame
     A tuple containing two pandas DataFrames. The first dataframe contains evaluation results for
     each batch from the test dataframe along with initial resource usage from fitting the model
     on the training data. The second dataframe contains true values, predictions and differences
     for each observation in the test dataset.</p>
<p>Example</p>
<hr />
<pre><code>&gt;&gt;&gt; from sklearn.datasets import make_classification
    from sklearn.tree import DecisionTreeClassifier
    from sklearn.metrics import accuracy_score
    # Generate synthetic data for classification
    X_train, y_train = make_classification(n_samples=1000)
    X_test, y_test = make_classification(n_samples=1000)
    # Convert to DataFrames and add target column
    train_df = pd.DataFrame(X_train)
    train_df['target'] = y_train
    test_df = pd.DataFrame(X_test)
    test_df['target'] = y_test
    # Initialize Decision Tree Classifier and evaluate using eval_bml_horizon function
    dtc = DecisionTreeClassifier()
    eval_results_df, true_preds_diffs_df = eval_bml_horizon(dtc, train_df,test_df,'target', 10, True, accuracy_score)
    # Print first 5 rows of evaluation results DataFrame
    print(eval_results_df.head())
    # Print first 5 rows of true values/predictions/differences DataFrame
    print(true_preds_diffs_df.head())
</code></pre>

      <details class="quote">
        <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_bml_horizon</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate a machine learning model on a rolling horizon basis.</span>

<span class="sd">    This function evaluates a machine learning model on a test dataset by making</span>
<span class="sd">    predictions on batches of size `horizon` from the test dataset. The model is</span>
<span class="sd">    first fit on the training dataset. The evaluation results are returned as a</span>
<span class="sd">    dataframe along with a dataframe containing the true values, predictions and</span>
<span class="sd">    differences for each observation in the test dataset.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : object</span>
<span class="sd">        A machine learning model object that has `fit` and `predict` methods.</span>

<span class="sd">    train : pd.DataFrame</span>
<span class="sd">        A pandas DataFrame containing the training data. The target column should be included in this dataframe.</span>

<span class="sd">     test : pd.DataFrame</span>
<span class="sd">         A pandas DataFrame containing the test data. The target column should be included in this dataframe.</span>

<span class="sd">     target_column : str</span>
<span class="sd">         The name of the target column in the train and test dataframes.</span>

<span class="sd">     horizon : int</span>
<span class="sd">         The size of each batch from the test dataframe to make predictions on.</span>

<span class="sd">     include_remainder : bool, optional (default=True)</span>
<span class="sd">         Whether to include remainder rows from the test dataframe when making predictions.</span>
<span class="sd">         If False, remainder rows will be removed before making predictions.</span>

<span class="sd">     metric : object</span>
<span class="sd">         An evaluation metric object that has an `evaluate` method.</span>
<span class="sd">         This metric will be used to evaluate the model&#39;s performance on each batch from the test dataframe.</span>

<span class="sd">     Returns</span>
<span class="sd">     -------</span>
<span class="sd">     tuple of pd.DataFrame</span>
<span class="sd">         A tuple containing two pandas DataFrames. The first dataframe contains evaluation results for</span>
<span class="sd">         each batch from the test dataframe along with initial resource usage from fitting the model</span>
<span class="sd">         on the training data. The second dataframe contains true values, predictions and differences</span>
<span class="sd">         for each observation in the test dataset.</span>

<span class="sd">     Example</span>
<span class="sd">     -------</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.datasets import make_classification</span>
<span class="sd">            from sklearn.tree import DecisionTreeClassifier</span>
<span class="sd">            from sklearn.metrics import accuracy_score</span>
<span class="sd">            # Generate synthetic data for classification</span>
<span class="sd">            X_train, y_train = make_classification(n_samples=1000)</span>
<span class="sd">            X_test, y_test = make_classification(n_samples=1000)</span>
<span class="sd">            # Convert to DataFrames and add target column</span>
<span class="sd">            train_df = pd.DataFrame(X_train)</span>
<span class="sd">            train_df[&#39;target&#39;] = y_train</span>
<span class="sd">            test_df = pd.DataFrame(X_test)</span>
<span class="sd">            test_df[&#39;target&#39;] = y_test</span>
<span class="sd">            # Initialize Decision Tree Classifier and evaluate using eval_bml_horizon function</span>
<span class="sd">            dtc = DecisionTreeClassifier()</span>
<span class="sd">            eval_results_df, true_preds_diffs_df = eval_bml_horizon(dtc, train_df,test_df,&#39;target&#39;, 10, True, accuracy_score)</span>
<span class="sd">            # Print first 5 rows of evaluation results DataFrame</span>
<span class="sd">            print(eval_results_df.head())</span>
<span class="sd">            # Print first 5 rows of true values/predictions/differences DataFrame</span>
<span class="sd">            print(true_preds_diffs_df.head())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if metric is None or null and raise ValueError if it is</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;metric&#39; parameter must not be None or null.&quot;</span><span class="p">)</span>
    <span class="c1"># Reset index of train and test dataframes</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Initialize lists for predictions and differences</span>
    <span class="n">preds_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">diffs_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Fit the model on the training data</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="c1"># Evaluate the model on empty arrays to get initial resource usage</span>
    <span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
        <span class="p">[</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="c1"># If include_remainder is False, remove remainder rows from test dataframe</span>
    <span class="k">if</span> <span class="n">include_remainder</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">remainder</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">%</span> <span class="n">horizon</span>
        <span class="k">if</span> <span class="n">remainder</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="o">-</span><span class="n">remainder</span><span class="p">]</span>
    <span class="c1"># Evaluate the model on batches of size horizon from the test dataframe</span>
    <span class="k">for</span> <span class="n">batch_number</span><span class="p">,</span> <span class="n">batch_df</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span> <span class="o">//</span> <span class="n">horizon</span><span class="p">):</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">batch_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">batch_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">])</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">batch_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">preds</span>
        <span class="n">df_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">batch_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="n">evaluate_model</span><span class="p">(</span>
                <span class="n">y_true</span><span class="o">=</span><span class="n">batch_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">],</span>
                <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span>
                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Append predictions and differences to their respective lists</span>
        <span class="n">preds_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
        <span class="n">diffs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
    <span class="c1"># Concatenate predictions and differences lists into series</span>
    <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">preds_list</span><span class="p">))</span>
    <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">diffs_list</span><span class="p">))</span>
    <span class="c1"># Create a dataframe with true values and add columns for predictions and differences</span>
    <span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_preds</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diffs</span>
    <span class="k">return</span> <span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.eval_bml_window" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_bml_window</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate a model on a rolling window basis.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The model to be evaluated.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>train</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The training data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>test</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The testing data set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_column</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column containing the target variable.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of steps ahead to forecast.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>tuple</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of two data frames. The first one contains evaluation metrics for each window.</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The second one contains the true and predicted values for each observation in the test set.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from sklearn.linear_model import LinearRegression
model = LinearRegression()
train = pd.DataFrame({"x": [1, 2, 3], "y": [2, 4, 6]})
test = pd.DataFrame({"x": [4, 5], "y": [8, 10]})
df_eval, df_true = eval_bml_window(model, train, test, "y", horizon=1)
print(df_eval)</p>
</blockquote>
</blockquote>
</blockquote>
</details>
      <details class="quote">
        <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_bml_window</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate a model on a rolling window basis.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (object): The model to be evaluated.</span>
<span class="sd">        train (pd.DataFrame): The training data set.</span>
<span class="sd">        test (pd.DataFrame): The testing data set.</span>
<span class="sd">        target_column (str): The name of the column containing the target variable.</span>
<span class="sd">        horizon (int, optional): The number of steps ahead to forecast.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple of two data frames. The first one contains evaluation metrics for each window.</span>
<span class="sd">        The second one contains the true and predicted values for each observation in the test set.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<span class="sd">        &gt;&gt;&gt; model = LinearRegression()</span>
<span class="sd">        &gt;&gt;&gt; train = pd.DataFrame({&quot;x&quot;: [1, 2, 3], &quot;y&quot;: [2, 4, 6]})</span>
<span class="sd">        &gt;&gt;&gt; test = pd.DataFrame({&quot;x&quot;: [4, 5], &quot;y&quot;: [8, 10]})</span>
<span class="sd">        &gt;&gt;&gt; df_eval, df_true = eval_bml_window(model, train, test, &quot;y&quot;, horizon=1)</span>
<span class="sd">        &gt;&gt;&gt; print(df_eval)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
        <span class="p">[</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">include_remainder</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">rem</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">%</span> <span class="n">horizon</span>
        <span class="k">if</span> <span class="n">rem</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="o">-</span><span class="n">rem</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">w_train</span><span class="p">,</span> <span class="n">w_test</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gen_horizon_shifted_window</span><span class="p">(</span><span class="n">df_all</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">),</span> <span class="n">horizon</span><span class="p">)):</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">w_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">w_train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">],</span> <span class="n">w_train</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">w_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">w_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">]))</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">w_test</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">preds</span>
        <span class="n">df_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="n">evaluate_model</span><span class="p">(</span>
                <span class="n">y_true</span><span class="o">=</span><span class="n">w_test</span><span class="p">[</span><span class="n">target_column</span><span class="p">],</span>
                <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span>
                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_preds</span><span class="p">,</span> <span class="n">preds</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_diffs</span><span class="p">,</span> <span class="n">diffs</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_preds</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diffs</span>
    <span class="k">return</span> <span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.eval_oml_horizon" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eval_oml_horizon</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">target_column</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">oml_grace_period</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate an online machine learning model.</p>
<h4 id="spotRiver.evaluation.eval_bml.eval_oml_horizon--parameters">Parameters</h4>

<details class="model-" open>
  <summary>object</summary>
  <p>The online machine learning model to be evaluated.</p>
</details>
<details class="train-" open>
  <summary>pd.DataFrame</summary>
  <p>The training data for the model.</p>
</details>
<details class="test-" open>
  <summary>pd.DataFrame</summary>
  <p>The testing data for the model.</p>
</details>
<details class="target_column-" open>
  <summary>str</summary>
  <p>The name of the column that contains the target variable.</p>
</details>
<details class="horizon-" open>
  <summary>int, optional</summary>
  <p>The number of rows to use for each landmark evaluation.</p>
</details>
<details class="metric" open>
  <summary>object</summary>
  <p>Metric, e.g., from sklearn.metrics: mean_squared_error</p>
</details>
<details class="oml_grace_period" open>
  <summary>int, optional</summary>
  <p>(Short) period used for training the OML before evaluation starts. Can be zero.
If set to None, horizon will be used.</p>
</details>      <h4 id="spotRiver.evaluation.eval_bml.eval_oml_horizon--returns">Returns</h4>
<p>tuple of pd.DataFrame
    The first element is a dataframe with evaluation metrics (RMSE, MAE, ACC, memory usage and time elapsed) for each iteration.
    The second element is a dataframe with the true values, predictions and differences for the test data.</p>
<h4 id="spotRiver.evaluation.eval_bml.eval_oml_horizon--examples">Examples</h4>
<blockquote>
<blockquote>
<blockquote>
<p>import pandas as pd
    import numpy as np
    from river import linear_model
    from river import preprocessing
    from sklearn.metrics import mean_squared_error
    model = preprocessing.StandardScaler() | linear_model.LinearRegression()
    dataset = datasets.TrumpApproval()
    train = pd.DataFrame(dataset.take(100))
    test = pd.DataFrame(dataset.take(100))
    target_column = "Approve"
    horizon = 10
    metric = mean_squared_error
    df_eval, df_preds = eval_oml_horizon(model, train, test, target_column, horizon, oml_grace_period, metric=metric)
    print(df_eval)
    print(df_preds)</p>
</blockquote>
</blockquote>
</blockquote>

      <details class="quote">
        <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eval_oml_horizon</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">oml_grace_period</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate an online machine learning model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : object</span>
<span class="sd">        The online machine learning model to be evaluated.</span>
<span class="sd">    train : pd.DataFrame</span>
<span class="sd">        The training data for the model.</span>
<span class="sd">    test : pd.DataFrame</span>
<span class="sd">        The testing data for the model.</span>
<span class="sd">    target_column : str</span>
<span class="sd">        The name of the column that contains the target variable.</span>
<span class="sd">    horizon : int, optional</span>
<span class="sd">        The number of rows to use for each landmark evaluation.</span>
<span class="sd">    metric: object</span>
<span class="sd">        Metric, e.g., from sklearn.metrics: mean_squared_error</span>
<span class="sd">    oml_grace_period: int, optional</span>
<span class="sd">        (Short) period used for training the OML before evaluation starts. Can be zero.</span>
<span class="sd">        If set to None, horizon will be used.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple of pd.DataFrame</span>
<span class="sd">        The first element is a dataframe with evaluation metrics (RMSE, MAE, ACC, memory usage and time elapsed) for each iteration.</span>
<span class="sd">        The second element is a dataframe with the true values, predictions and differences for the test data.</span>

<span class="sd">    Examples</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        from river import linear_model</span>
<span class="sd">        from river import preprocessing</span>
<span class="sd">        from sklearn.metrics import mean_squared_error</span>
<span class="sd">        model = preprocessing.StandardScaler() | linear_model.LinearRegression()</span>
<span class="sd">        dataset = datasets.TrumpApproval()</span>
<span class="sd">        train = pd.DataFrame(dataset.take(100))</span>
<span class="sd">        test = pd.DataFrame(dataset.take(100))</span>
<span class="sd">        target_column = &quot;Approve&quot;</span>
<span class="sd">        horizon = 10</span>
<span class="sd">        metric = mean_squared_error</span>
<span class="sd">        df_eval, df_preds = eval_oml_horizon(model, train, test, target_column, horizon, oml_grace_period, metric=metric)</span>
<span class="sd">        print(df_eval)</span>
<span class="sd">        print(df_preds)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if metric is None or null and raise ValueError if it is</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;metric&#39; parameter must not be None or null.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">oml_grace_period</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">oml_grace_period</span> <span class="o">=</span> <span class="n">horizon</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_remainder</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">rem</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">%</span> <span class="n">horizon</span>
        <span class="k">if</span> <span class="n">rem</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="o">-</span><span class="n">rem</span><span class="p">]</span>
    <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Initial Training on Train Data</span>
    <span class="c1"># For OML, this is performed on a limited subset only (oml_grace_period).</span>
    <span class="n">train_X</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">]</span>
    <span class="n">train_y</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span>
    <span class="n">train_X</span> <span class="o">=</span> <span class="n">train_X</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">oml_grace_period</span><span class="p">)</span>
    <span class="n">train_y</span> <span class="o">=</span> <span class="n">train_y</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">oml_grace_period</span><span class="p">)</span>
    <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">river_stream</span><span class="o">.</span><span class="n">iter_pandas</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">):</span>
            <span class="c1"># The following line returns y_pred, which is not used, therefore set to &quot;_&quot;:</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_one</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
            <span class="c1"># metric = metric.update(yi, y_pred)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">learn_one</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
    <span class="c1"># TODO: Add error handling</span>
    <span class="c1"># Return res_dict = {&quot;Metric&quot;: score, &quot;Memory (MB)&quot;: memory, &quot;CompTime (s)&quot;: r_time}</span>
    <span class="n">df_eval</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
        <span class="p">[</span><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="c1"># Test Data Evaluation</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gen_sliding_window</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)):</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">test_X</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">new_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">target_column</span><span class="p">]</span>
        <span class="n">test_y</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="n">ResourceMonitor</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">rm</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">river_stream</span><span class="o">.</span><span class="n">iter_pandas</span><span class="p">(</span><span class="n">test_X</span><span class="p">,</span> <span class="n">test_y</span><span class="p">):</span>
                <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_one</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
                <span class="n">preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>  <span class="c1"># This is falsly measured with the ResourceMonitor</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">learn_one</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">preds</span>
        <span class="n">df_eval</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
            <span class="n">evaluate_model</span><span class="p">(</span>
                <span class="n">y_true</span><span class="o">=</span><span class="n">new_df</span><span class="p">[</span><span class="n">target_column</span><span class="p">],</span>
                <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span>
                <span class="n">memory</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                <span class="n">r_time</span><span class="o">=</span><span class="n">rm</span><span class="o">.</span><span class="n">r_time</span><span class="p">,</span>
                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">series_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_preds</span><span class="p">,</span> <span class="n">preds</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">series_diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_diffs</span><span class="p">,</span> <span class="n">diffs</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">target_column</span><span class="p">])</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_preds</span>
    <span class="n">df_true</span><span class="p">[</span><span class="s2">&quot;Difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_diffs</span>
    <span class="k">return</span> <span class="n">df_eval</span><span class="p">,</span> <span class="n">df_true</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.evaluate_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">r_time</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Evaluate a model's performance based on its predictions and ground truth values.</p>
<h4 id="spotRiver.evaluation.eval_bml.evaluate_model--parameters">Parameters</h4>
<p>y_true: Ground truth values as a numpy array.
y_pred: Predicted values as a numpy array.
memory: Memory usage in MB.
r_time: Computation time in seconds.
metric: A function that takes in two arguments (y_true and y_pred) and returns a score.</p>
<h4 id="spotRiver.evaluation.eval_bml.evaluate_model--returns">Returns</h4>
<p>A dictionary containing the evaluation results including the metric score, memory usage and computation time.</p>
<h4 id="spotRiver.evaluation.eval_bml.evaluate_model--example">Example</h4>
<blockquote>
<blockquote>
<blockquote>
<p>from sklearn.metrics import mean_squared_error
    import numpy as np
    y_true = np.array([1.0, 2.0, 3.0])
    y_pred = np.array([1.1, 2.1, 2.9])
    memory = 100
    r_time = 0.5
    result = evaluate_model(y_true=y_true,
                            y_pred=y_pred,
                            memory=memory,
                            r_time=r_time,
                            metric=mean_squared_error)
    print(result)</p>
</blockquote>
</blockquote>
</blockquote>
<pre><code># Output:
# {'Metric': 0.00666666666666671, 'Memory (MB)': 100, 'CompTime (s)': 0.5}
</code></pre>

      <details class="quote">
        <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">memory</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">r_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">metric</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate a model&#39;s performance based on its predictions and ground truth values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true: Ground truth values as a numpy array.</span>
<span class="sd">    y_pred: Predicted values as a numpy array.</span>
<span class="sd">    memory: Memory usage in MB.</span>
<span class="sd">    r_time: Computation time in seconds.</span>
<span class="sd">    metric: A function that takes in two arguments (y_true and y_pred) and returns a score.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A dictionary containing the evaluation results including the metric score, memory usage and computation time.</span>

<span class="sd">    Example</span>
<span class="sd">    ------</span>
<span class="sd">    &gt;&gt;&gt; from sklearn.metrics import mean_squared_error</span>
<span class="sd">        import numpy as np</span>
<span class="sd">        y_true = np.array([1.0, 2.0, 3.0])</span>
<span class="sd">        y_pred = np.array([1.1, 2.1, 2.9])</span>
<span class="sd">        memory = 100</span>
<span class="sd">        r_time = 0.5</span>
<span class="sd">        result = evaluate_model(y_true=y_true,</span>
<span class="sd">                                y_pred=y_pred,</span>
<span class="sd">                                memory=memory,</span>
<span class="sd">                                r_time=r_time,</span>
<span class="sd">                                metric=mean_squared_error)</span>
<span class="sd">        print(result)</span>

<span class="sd">        # Output:</span>
<span class="sd">        # {&#39;Metric&#39;: 0.00666666666666671, &#39;Memory (MB)&#39;: 100, &#39;CompTime (s)&#39;: 0.5}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;y_true and y_pred must have the same size&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">res_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">:</span> <span class="n">memory</span><span class="p">,</span>
            <span class="s2">&quot;CompTime (s)&quot;</span><span class="p">:</span> <span class="n">r_time</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">res_dict</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">metric</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">res_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Metric&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">,</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">:</span> <span class="n">memory</span><span class="p">,</span> <span class="s2">&quot;CompTime (s)&quot;</span><span class="p">:</span> <span class="n">r_time</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">res_dict</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.gen_sliding_window" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gen_sliding_window</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">include_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Generates sliding windows of a given size from a DataFrame.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td>
                <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input DataFrame.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the sliding window.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_remainder</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include the remainder of the DataFrame if its length is not divisible by the horizon. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Yields:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Generator">Generator</span>[<span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span>, None, None]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>pd.DataFrame: A sliding window of the input DataFrame.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})
for window in gen_sliding_window(df, 2):
...     print(window)
   A  B
0  1  4
1  2  5
   A  B
2  3  6</p>
</blockquote>
</blockquote>
</blockquote>
</details>
      <details class="quote">
        <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">gen_sliding_window</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">include_remainder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates sliding windows of a given size from a DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The input DataFrame.</span>
<span class="sd">        horizon (int): The size of the sliding window.</span>
<span class="sd">        include_remainder (bool): Whether to include the remainder of the DataFrame if its length is not divisible by the horizon. Defaults to False.</span>

<span class="sd">    Yields:</span>
<span class="sd">        pd.DataFrame: A sliding window of the input DataFrame.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame({&#39;A&#39;: [1, 2, 3], &#39;B&#39;: [4, 5, 6]})</span>
<span class="sd">        &gt;&gt;&gt; for window in gen_sliding_window(df, 2):</span>
<span class="sd">        ...     print(window)</span>
<span class="sd">           A  B</span>
<span class="sd">        0  1  4</span>
<span class="sd">        1  2  5</span>
<span class="sd">           A  B</span>
<span class="sd">        2  3  6</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">horizon</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">horizon</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">horizon</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">include_remainder</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">subset</span>
            <span class="k">break</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">yield</span> <span class="n">subset</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_bml_oml_horizon_metrics</span><span class="p">(</span><span class="n">df_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Plot metrics for benchmarking machine learning models.</p>
<p>This function plots three metrics: mean absolute error (MAE)/ Accuracy, memory usage (MB),
and computation time (s) for different machine learning models on a given dataset.
The function takes a list of pandas dataframes as input, each containing the metrics
for one model. The function also takes an optional list of labels for each model
and boolean flags to indicate whether to use logarithmic scales for the x-axis
and y-axis.</p>
<h4 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--parameters">Parameters</h4>

<details class="df_eval-" open>
  <summary>list[pd.DataFrame], optional</summary>
  <p>A list of pandas dataframes containing the metrics for each model.
Each dataframe should have an index column with the dataset name
and three columns with the metric names: "MAE"/"ACC", "Memory (MB)", "CompTime (s)".
If None, no plot is generated. Default is None.</p>
</details>
<details class="df_labels-" open>
  <summary>list, optional</summary>
  <p>A list of strings containing the labels for each model.
The length of this list should match the length of df_eval.
If None, numeric indices are used as labels. Default is None.</p>
</details>
<details class="log_x-" open>
  <summary>bool, optional</summary>
  <p>A flag indicating whether to use logarithmic scale for the x-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
</details>
<details class="log_y-" open>
  <summary>bool, optional</summary>
  <p>A flag indicating whether to use logarithmic scale for the y-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
</details>
<details class="cumulative-" open>
  <summary>bool, optional:</summary>
  <p>A flag indicating whether to plot the cumulative average error as it is done in
<code>plot_oml_iter_progressive()</code> and in <code>river</code>'s <code>evaluate.iter_progressive_val_score()</code>
method. Time is shown as a cumulative sum (not averaged). Since memory is calculated
in a different way than in <code>river</code>'s <code>evaluate.iter_progressive_val_score()</code>, the peak
memory from <code>_ , peak = tracemalloc.get_traced_memory()</code> is shown in a non-aggregated way.
Default is True.</p>
</details>
<details class="grid" open>
  <summary>bool, optional</summary>
  <p>A flag indicating whether to plot a grid.
If True, grid is shown. Default is True.</p>
</details>      <p>figsize (tuple, optional): The size of the figure. Defaults to None, in which case
        the default figure size <code>(10, 5)</code> is used.</p>

<details class="filename" open>
  <summary>str, optional. Default: None.</summary>
  <p>If not None, the plot is saved to the specified file.</p>
</details>      <p>**kwargs : dict
    Additional keyword arguments passed to plt.plot() function.</p>
<h4 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--returns">Returns</h4>
<p>None</p>
<h4 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_metrics--example">Example</h4>
<blockquote>
<blockquote>
<blockquote>
<p>d1 = {'MAE': [0.1, 0.2], 'Memory (MB)': [10 , 20], 'CompTime (s)': [1 , 2]}
    d2 = {'MAE': [0.3 , 0.4], 'Memory (MB)': [30 , 40], 'CompTime (s)': [3 , 4]}
    # create dataframes from dictionaries
    df_eval1 = pd.DataFrame(data=d1)
    df_eval2 = pd.DataFrame(data=d2)
    # create a list of dataframes
    df_eval_list = [df_eval1 , df_eval2]
    # plot evaluation metrics for each element of df_eval_list
    plot_bml_oml_metrics(df_eval=df_eval_list)</p>
</blockquote>
</blockquote>
</blockquote>

      <details class="quote">
        <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_bml_oml_horizon_metrics</span><span class="p">(</span>
    <span class="n">df_eval</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">df_labels</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot metrics for benchmarking machine learning models.</span>

<span class="sd">    This function plots three metrics: mean absolute error (MAE)/ Accuracy, memory usage (MB),</span>
<span class="sd">    and computation time (s) for different machine learning models on a given dataset.</span>
<span class="sd">    The function takes a list of pandas dataframes as input, each containing the metrics</span>
<span class="sd">    for one model. The function also takes an optional list of labels for each model</span>
<span class="sd">    and boolean flags to indicate whether to use logarithmic scales for the x-axis</span>
<span class="sd">    and y-axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_eval : list[pd.DataFrame], optional</span>
<span class="sd">        A list of pandas dataframes containing the metrics for each model.</span>
<span class="sd">        Each dataframe should have an index column with the dataset name</span>
<span class="sd">        and three columns with the metric names: &quot;MAE&quot;/&quot;ACC&quot;, &quot;Memory (MB)&quot;, &quot;CompTime (s)&quot;.</span>
<span class="sd">        If None, no plot is generated. Default is None.</span>

<span class="sd">    df_labels : list, optional</span>
<span class="sd">        A list of strings containing the labels for each model.</span>
<span class="sd">        The length of this list should match the length of df_eval.</span>
<span class="sd">        If None, numeric indices are used as labels. Default is None.</span>

<span class="sd">    log_x : bool, optional</span>
<span class="sd">        A flag indicating whether to use logarithmic scale for the x-axis.</span>
<span class="sd">        If True, log scale is used. If False, linear scale is used. Default is False.</span>

<span class="sd">    log_y : bool, optional</span>
<span class="sd">        A flag indicating whether to use logarithmic scale for the y-axis.</span>
<span class="sd">        If True, log scale is used. If False, linear scale is used. Default is False.</span>

<span class="sd">    cumulative : bool, optional:</span>
<span class="sd">        A flag indicating whether to plot the cumulative average error as it is done in</span>
<span class="sd">        `plot_oml_iter_progressive()` and in `river`&#39;s ` evaluate.iter_progressive_val_score()`</span>
<span class="sd">        method. Time is shown as a cumulative sum (not averaged). Since memory is calculated</span>
<span class="sd">        in a different way than in `river`&#39;s ` evaluate.iter_progressive_val_score()`, the peak</span>
<span class="sd">        memory from `_ , peak = tracemalloc.get_traced_memory()` is shown in a non-aggregated way.</span>
<span class="sd">        Default is True.</span>

<span class="sd">    grid: bool, optional</span>
<span class="sd">        A flag indicating whether to plot a grid.</span>
<span class="sd">        If True, grid is shown. Default is True.</span>

<span class="sd">    figsize (tuple, optional): The size of the figure. Defaults to None, in which case</span>
<span class="sd">            the default figure size `(10, 5)` is used.</span>

<span class="sd">    filename: str, optional. Default: None.</span>
<span class="sd">        If not None, the plot is saved to the specified file.</span>

<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments passed to plt.plot() function.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; d1 = {&#39;MAE&#39;: [0.1, 0.2], &#39;Memory (MB)&#39;: [10 , 20], &#39;CompTime (s)&#39;: [1 , 2]}</span>
<span class="sd">        d2 = {&#39;MAE&#39;: [0.3 , 0.4], &#39;Memory (MB)&#39;: [30 , 40], &#39;CompTime (s)&#39;: [3 , 4]}</span>
<span class="sd">        # create dataframes from dictionaries</span>
<span class="sd">        df_eval1 = pd.DataFrame(data=d1)</span>
<span class="sd">        df_eval2 = pd.DataFrame(data=d2)</span>
<span class="sd">        # create a list of dataframes</span>
<span class="sd">        df_eval_list = [df_eval1 , df_eval2]</span>
<span class="sd">        # plot evaluation metrics for each element of df_eval_list</span>
<span class="sd">        plot_bml_oml_metrics(df_eval=df_eval_list)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="c1"># Check if metric is None or null and raise ValueError if it is</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;metric&#39; parameter must not be None or null.&quot;</span><span class="p">)</span>
    <span class="c1"># Check if input dataframes are provided</span>
    <span class="k">if</span> <span class="n">df_eval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">df_eval</span><span class="p">)</span>
        <span class="c1"># Convert single dataframe input to a list if needed</span>
        <span class="k">if</span> <span class="n">df_list</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_list</span><span class="p">]</span>
        <span class="c1"># Define metric names and titles</span>
        <span class="n">metric_name</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">,</span> <span class="s2">&quot;CompTime (s)&quot;</span><span class="p">,</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">]</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">metric_name</span><span class="p">,</span> <span class="s2">&quot;Computation time (s)&quot;</span><span class="p">,</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">]</span>
        <span class="c1"># Create subplots with shared x-axis</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Loop over each dataframe in input list</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cumulative</span><span class="p">:</span>
                <span class="c1"># df.MAE = np.cumsum(df.MAE) / range(1, (1 + df.MAE.size))</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Metric&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;CompTime (s)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;CompTime (s)&quot;</span><span class="p">])</span>  <span class="c1"># / range(1, (1 + df[&quot;CompTime (s)&quot;].size))</span>
                <span class="c1"># df[&quot;Memory (MB)&quot;] = np.cumsum(df[&quot;Memory (MB)&quot;]) / range(1, (1 + df[&quot;Memory (MB)&quot;].size))</span>
            <span class="c1"># Loop over each metric</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="c1"># Assign label based on input or default value</span>
                <span class="k">if</span> <span class="n">df_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">df_labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># Plot metric values against dataset names</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">metrics</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="c1"># Set title and legend</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
                <span class="c1"># Set logarithmic scales if specified</span>
                <span class="k">if</span> <span class="n">log_x</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">log_y</span><span class="p">:</span>
                    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_bml_oml_horizon_predictions</span><span class="p">(</span><span class="n">df_true</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">df_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_column</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">skip_first_n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Plot actual vs predicted values for machine learning models.</p>
<p>This function plots the actual values of a target variable (e.g., vibration)
against the predicted values from different machine learning models on
a given dataset. The function takes a list of pandas dataframes as input,
each containing the actual and predicted values for one model. The function
also takes an optional list of labels for each model and boolean flags
to indicate whether to use logarithmic scales for the x-axis and y-axis.</p>
<h4 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--parameters">Parameters</h4>

<details class="df_true-" open>
  <summary>list[pd.DataFrame], optional</summary>
  <p>A list of pandas dataframes containing the actual and predicted values
for each model. Each dataframe should have an index column with the
dataset name and two columns with the label names: e.g., "Vibration"
and "Prediction". If None, no plot is generated. Default is None.</p>
</details>
<details class="df_labels-" open>
  <summary>list, optional</summary>
  <p>A list of strings containing the labels for each model.
The length of this list should match the length of df_eval.
If None, numeric indices are used as labels. Default is None.</p>
</details>
<details class="target_column-" open>
  <summary>optional</summary>
  <p>String containing the target column.
Default is "Actual".</p>
</details>
<details class="log_x-" open>
  <summary>bool, optional</summary>
  <p>A flag indicating whether to use logarithmic scale for the x-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
</details>
<details class="log_y-" open>
  <summary>bool, optional</summary>
  <p>A flag indicating whether to use logarithmic scale for the y-axis.
If True, log scale is used. If False, linear scale is used. Default is False.</p>
</details>
<details class="skip_first_n" open>
  <summary>int, optional</summary>
  <p>Skip the first n entries in the plot.</p>
</details>
<details class="grid" open>
  <summary>bool, optional</summary>
  <p>A flag indicating whether to plot a grid.
If True, grid is shown. Default is True.</p>
</details>      <p>figsize (tuple, optional): The size of the figure in inches.
        Defaults to None, in which case
        the default figure size <code>(10, 5)</code> is used.</p>

<details class="filename" open>
  <summary>str, optional. Default: None</summary>
  <p>If not None, save the plot to a file.</p>
</details>      <p>**kwargs : dict
    Additional keyword arguments passed to plt.plot() function.</p>
<h4 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--returns">Returns</h4>
<p>None</p>
<h4 id="spotRiver.evaluation.eval_bml.plot_bml_oml_horizon_predictions--example">Example</h4>
<blockquote>
<blockquote>
<blockquote>
<p>d3 = {'Vibration': [0.5 , 0.6], 'Prediction': [0.7 , 0.8]}
    # create dataframes from dictionaries
    df_true = pd.DataFrame(data=d3)
    # plot actual vs predicted values from df_true
    plot_bml_oml_horizon_predictions(df_true=df_true)</p>
</blockquote>
</blockquote>
</blockquote>

      <details class="quote">
        <summary>Source code in <code>/Users/bartz/miniforge3/envs/spotCondaEnv/lib/python3.10/site-packages/spotRiver/evaluation/eval_bml.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_bml_oml_horizon_predictions</span><span class="p">(</span>
    <span class="n">df_true</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">df_labels</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">target_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Actual&quot;</span><span class="p">,</span>
    <span class="n">log_x</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_first_n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot actual vs predicted values for machine learning models.</span>

<span class="sd">    This function plots the actual values of a target variable (e.g., vibration)</span>
<span class="sd">    against the predicted values from different machine learning models on</span>
<span class="sd">    a given dataset. The function takes a list of pandas dataframes as input,</span>
<span class="sd">    each containing the actual and predicted values for one model. The function</span>
<span class="sd">    also takes an optional list of labels for each model and boolean flags</span>
<span class="sd">    to indicate whether to use logarithmic scales for the x-axis and y-axis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_true : list[pd.DataFrame], optional</span>
<span class="sd">        A list of pandas dataframes containing the actual and predicted values</span>
<span class="sd">        for each model. Each dataframe should have an index column with the</span>
<span class="sd">        dataset name and two columns with the label names: e.g., &quot;Vibration&quot;</span>
<span class="sd">        and &quot;Prediction&quot;. If None, no plot is generated. Default is None.</span>

<span class="sd">    df_labels : list, optional</span>
<span class="sd">        A list of strings containing the labels for each model.</span>
<span class="sd">        The length of this list should match the length of df_eval.</span>
<span class="sd">        If None, numeric indices are used as labels. Default is None.</span>

<span class="sd">    target_column : optional</span>
<span class="sd">        String containing the target column.</span>
<span class="sd">        Default is &quot;Actual&quot;.</span>

<span class="sd">    log_x : bool, optional</span>
<span class="sd">        A flag indicating whether to use logarithmic scale for the x-axis.</span>
<span class="sd">        If True, log scale is used. If False, linear scale is used. Default is False.</span>

<span class="sd">    log_y : bool, optional</span>
<span class="sd">        A flag indicating whether to use logarithmic scale for the y-axis.</span>
<span class="sd">        If True, log scale is used. If False, linear scale is used. Default is False.</span>

<span class="sd">    skip_first_n: int, optional</span>
<span class="sd">        Skip the first n entries in the plot.</span>

<span class="sd">    grid: bool, optional</span>
<span class="sd">        A flag indicating whether to plot a grid.</span>
<span class="sd">        If True, grid is shown. Default is True.</span>

<span class="sd">    figsize (tuple, optional): The size of the figure in inches.</span>
<span class="sd">            Defaults to None, in which case</span>
<span class="sd">            the default figure size `(10, 5)` is used.</span>

<span class="sd">    filename: str, optional. Default: None</span>
<span class="sd">        If not None, save the plot to a file.</span>

<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments passed to plt.plot() function.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; d3 = {&#39;Vibration&#39;: [0.5 , 0.6], &#39;Prediction&#39;: [0.7 , 0.8]}</span>
<span class="sd">        # create dataframes from dictionaries</span>
<span class="sd">        df_true = pd.DataFrame(data=d3)</span>
<span class="sd">        # plot actual vs predicted values from df_true</span>
<span class="sd">        plot_bml_oml_horizon_predictions(df_true=df_true)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df_true</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_plot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">df_true</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">df_plot</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">df_plot</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_plot</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_plot</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">df_labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">df_labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span> <span class="n">skip_first_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Prediction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Prediction&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">target_column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Actual&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Actual vs Prediction&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_x</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_y</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>